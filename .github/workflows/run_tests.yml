# produce yaml file cron job
name: FaunaDB scrapping
on:
  push:
    branches:
      - 'main'
      - "feature/*"
    paths-ignore:
      - ".github/workflows/*.yml"
  schedule:
    # * is a special character in YAML so you have to quote this string
    - cron:  '10 2-18/2 * * 1-5'

env:
  FAUNA_SECRET: ${{ secrets.FAUNA_AI_ACCESS_TOKEN }}
  DISCORD_WEBHOOK: ${{ secrets.DISCORD_DAILY_REVIEW_WEBHOOK }}
  DISCORD_CRITICAL_WEBHOOK: ${{ secrets.DISCORD_CRITICAL_WEBHOOK }}
# Add cron job to ensure external webpages + apis have no changed
jobs:
  scrap_data:
    runs-on: ubuntu-latest
    name: beneath

    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-python@v3
        with:
          python-version: '3.9' # Version range or exact version of a Python version to use, using SemVer's version range syntax
          architecture: 'x64'
      - name: Install Dependencies
        run: |
          python3 -m pip install -r requirements.txt
          python3 -m spacy download en_core_web_trf
          python3 -m spacy download en_core_web_lg
          python3 -m coreferee install en
      - name: Crawl
        run:  |
         python3 -m unitest
